<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Inspector</title>
    
    <link rel="stylesheet" href="style.css?v=1.0"> 



</head>
<body>

    <nav>
        <!-- Left Empty Space -->
        <div class="nav-left"></div>
    
        <!-- Center Links -->
        <div class="nav-center">
            <a href="index.html">Home</a>
            <a href="Contact.html">Contact</a>
            <a href="https://github.com/gar-mart/SQLInspector/tree/master/SQLInspector" target="_blank">Github</a>
        </div>
    
        <!-- Right Aligned Download Button -->
        <div class="nav-download">
            <a href="SQLInspector.sql" download class="download-btn">Download</a>

        </div>
    </nav>
    
    

    <div class="sidebar">
        <a href="#Overview">Overview</a>
        <a href="#sp_sqlins_help">sp_sqlins_help</a>
        <a href="#sp_backup_info">sp_backup_info</a>
        <a href="#sp_table_sizes">sp_table_sizes</a>
        <a href="#sp_current_locks">sp_current_locks</a>
        <a href="#sp_active_tran">sp_active_tran</a>
        <a href="#sp_index_usage">sp_index_usage</a>
        <a href="#sp_missing_indexes">sp_missing_indexes</a>
        <a href="#sp_index_frag">sp_index_frag</a>
        <a href="#sp_long_queries">sp_long_queries</a>
        <a href="#sp_long_proc_xe">sp_long_proc_xe</a>
        <a href="#sp_job_info">sp_job_info</a>
        <a href="#sp_long_jobs">sp_long_jobs</a>
    </div>
    
    
    
 
<div class="content">

 
    <div id="Overview">
   
        <div class="description">
            <h2>Overview</h2>
            <p>Here is a collection of stored procedures I developed and have been using to monitor and optimize SQL Server databases. These scripts provide insights into various aspects of database performance, identify areas for improvement, potential issues such as inefficient resource utilization, missing or unnecessary components, costly queries, and more. They expose the problems and their root causes within your SQL Server, providing clear guidance to optimize the database.</p>
        </div>
    </div>
    <br />

    <div id="sp_sqlins_help">
   
        <div class="description-text">
            <h2 class="codehd">sp_sqlins_help</h2>
            <br>
           <p>Provides detailed information about the procedures in SQLInspector. It takes an optional parameter, <code>@proc_name</code>, which represents the name of the specific procedure you want to learn about. </p> 
           <br />
           <p>If specified, outputs the description of the said procedure, any parameters with their descriptions, as well as the output results produced by the procedure along with explanations.</p>
           <br />
           <p>If the optional parameter is not specified, lists all the procedures with short descriptions of what they do.</p>
        </div>
    
       
    </div>


    <div id="sp_backup_info">
   
    <div class="description-text">
        <h2 class="codehd">sp_backup_info</h2>
        <br>
        Retrieves and displays detailed backup information for each database on the SQL Server instance. 
    </div>

    <div class="description-text">

    <h3 class="table-header">Output</h3>
    <div class="description-table-container">
        <table class="description-table">
            <thead>
                <tr>
                    <th>Column</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td data-label="Column">database_id</td>
                    <td data-label="Description">The unique identifier for each database in the SQL Server instance.</td>
                </tr>
                <tr>
                    <td data-label="Column">name</td>
                    <td data-label="Description">The name of the database.</td>
                </tr>
                <tr>
                    <td data-label="Column">state_desc</td>
                    <td data-label="Description">The current state of the database (e.g., ONLINE, OFFLINE, RECOVERING).</td>
                </tr>
                <tr>
                    <td data-label="Column">recovery_model_desc</td>
                    <td data-label="Description">The recovery model of the database (e.g., FULL, SIMPLE, BULK_LOGGED).</td>
                </tr>
                <tr>
                    <td data-label="Column">data_size</td>
                    <td data-label="Description">The total size of all data files in the database, measured in megabytes (MB).</td>
                </tr>
                <tr>
                    <td data-label="Column">log_size</td>
                    <td data-label="Description">The total size of all log files in the database, measured in megabytes (MB).</td>
                </tr>
                <tr>
                    <td data-label="Column">full_last_date</td>
                    <td data-label="Description">The date and time of the last full backup for the database.</td>
                </tr>
                <tr>
                    <td data-label="Column">full_size</td>
                    <td data-label="Description">The size of the last full backup for the database, measured in bytes.</td>
                </tr>
                <tr>
                    <td data-label="Column">log_last_date</td>
                    <td data-label="Description">The date and time of the last transaction log backup for the database.</td>
                </tr>
                <tr>
                    <td data-label="Column">last_log_backup_size</td>
                    <td data-label="Description">The size of the last transaction log backup for the database, measured in bytes.</td>
                </tr>
            </tbody>
        </table>
    </div>
        </div>
    </div>
    
    <div id="sp_table_sizes">
            <!-- Procedure Description -->
            <div class="description-text">
                <h2 class="codehd">sp_table_sizes</h2>
                <br>
                Displays detailed information about table sizes in the database.
            </div>
        
        
            <!-- Input Parameter -->
            <div class="description-text">
                <h3 class="table-header">Parameter</h3>
                <br />
                <p><code>@schema</code> - Specifies the schema for filtering the tables. If <code>NULL</code>, returns results for all schemas.</p>
            </div>
        
            <!-- Output Columns -->
            <div class="description-text">
                <h3 class="table-header">Output</h3>
                <div class="description-table-container">
                    <table class="description-table">
                        <thead>
                            <tr>
                                <th>Column</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td data-label="Column">schema_name</td>
                                <td data-label="Description">The name of the schema containing the table.</td>
                            </tr>
                            <tr>
                                <td data-label="Column">table_name</td>
                                <td data-label="Description">The name of the table.</td>
                            </tr>
                            <tr>
                                <td data-label="Column">row_counts</td>
                                <td data-label="Description">The number of rows in the table.</td>
                            </tr>
                            <tr>
                                <td data-label="Column">total_space_kb</td>
                                <td data-label="Description">The total allocated space for the table, in kilobytes.</td>
                            </tr>
                            <tr>
                                <td data-label="Column">used_space_kb</td>
                                <td data-label="Description">The space actively used by the table, in kilobytes.</td>
                            </tr>
                            <tr>
                                <td data-label="Column">unused_space_kb</td>
                                <td data-label="Description">The allocated but unused space for the table, in kilobytes.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
    </div>
   
    <div id="sp_current_locks">

        <div class="description-text">
            <h2 class="codehd">sp_current_locks</h2>
            <br>
            Provides information about the current locks held by sessions on various database resources.
        </div>
        <div class="description-text">
            <h3 class="table-header">Output</h3>
    
        <div class="description-table-container">
            <table class="description-table">
                <thead>
                    <tr>
                        <th>Column</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td data-label="Column">session_id</td>
                        <td data-label="Description">The ID of the session holding or requesting the lock.</td>
                    </tr>
                    <tr>
                        <td data-label="Column">database_name</td>
                        <td data-label="Description">The name of the database where the lock is held.</td>
                    </tr>
                    <tr>
                        <td data-label="Column">resource_associated_entity_id</td>
                        <td data-label="Description">The ID of the resource associated with the lock (e.g., object, partition).</td>
                    </tr>
                    <tr>
                        <td data-label="Column">entity_name</td>
                        <td data-label="Description">The name of the resource associated with the lock (e.g., table or index).</td>
                    </tr>
                    <tr>
                        <td data-label="Column">index_id</td>
                        <td data-label="Description">The ID of the index associated with the lock, if applicable.</td>
                    </tr>
                    <tr>
                        <td data-label="Column">resource</td>
                        <td data-label="Description">The type of resource being locked (e.g., OBJECT, KEY, PAGE, EXTENT).</td>
                    </tr>
                    <tr>
                        <td data-label="Column">description</td>
                        <td data-label="Description">Additional details about the locked resource (e.g., page ranges, key details).</td>
                    </tr>
                    <tr>
                        <td data-label="Column">mode</td>
                        <td data-label="Description">The lock mode (e.g., SHARED, EXCLUSIVE), which indicates the type of operation requiring the lock.</td>
                    </tr>
                    <tr>
                        <td data-label="Column">status</td>
                        <td data-label="Description">The status of the lock request (e.g., GRANTED, WAITING).</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        </div>  
    </div>  

    <div id="sp_active_tran">

    <div class="description-text">
        <h2 class="codehd">sp_active_tran</h2>
        <br>
        Provides details about active transactions within the SQL Server instance, offering insights into transaction metadata, associated sessions, and their recent execution plans.
    </div>
    
    <div class="description-text">
        <h3 class="table-header">Output</h3>

    <div class="description-table-container">
        
        <table class="description-table">
            <thead>
                <tr>
                    <th>Column</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td data-label="Column">session_id</td>
                    <td data-label="Description">The ID of the session associated with the transaction.</td>
                </tr>
                <tr>
                    <td data-label="Column">login_name</td>
                    <td data-label="Description">The login name of the user initiating the session.</td>
                </tr>
                <tr>
                    <td data-label="Column">database_name</td>
                    <td data-label="Description">The name of the database involved in the transaction.</td>
                </tr>
                <tr>
                    <td data-label="Column">begin_time</td>
                    <td data-label="Description">The timestamp when the database transaction began.</td>
                </tr>
                <tr>
                    <td data-label="Column">log_bytes</td>
                    <td data-label="Description">The number of log bytes used by the database transaction.</td>
                </tr>
                <tr>
                    <td data-label="Column">log_bytes_reserved</td>
                    <td data-label="Description">The number of log bytes reserved for the transaction.</td>
                </tr>
                <tr>
                    <td data-label="Column">sql_text</td>
                    <td data-label="Description">The SQL statement most recently executed in the session.</td>
                </tr>
                <tr>
                    <td data-label="Column">last_plan</td>
                    <td data-label="Description">The execution plan associated with the most recent SQL query in the session.</td>
                </tr>
            </tbody>
        </table>
    </div>
    </div>
    </div>
         
   
      


    <div id="sp_index_usage">
        <!-- Procedure Description -->
        <div class="description-text">
            <h2 class="codehd">sp_index_usage</h2>
            <br>
            Retrieves index usage statistics, showing which indexes are frequently used, as opposed to unused or rarely used ones.
        </div>
    
        <!-- Purpose Section -->
   
    
        <!-- Input Parameter -->
        <div class="description-text">
            <h3 class="table-header">Parameter</h3>
            <br />
            <p><code>@database_name</code> - The name of the database to display index usage information for, if <code>NULL</code>, retrieves indexes for all databases.</p>
        </div>
    
        <!-- Output Columns -->
        <div class="description-text">
            <h3 class="table-header">Output</h3>
            <div class="description-table-container">
                <table class="description-table">
                    <thead>
                        <tr>
                            <th>Column Name</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td data-label="Column">table_name</td>
                            <td data-label="Description">The name of the table where the index resides.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">index_name</td>
                            <td data-label="Description">The name of the index being analyzed.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">user_seeks</td>
                            <td data-label="Description">Number of seek operations performed on the index.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">user_scans</td>
                            <td data-label="Description">Number of scan operations performed on the index.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">user_lookups</td>
                            <td data-label="Description">Number of lookup operations performed on the index.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">user_updates</td>
                            <td data-label="Description">Number of updates to the index.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">last_user_seek</td>
                            <td data-label="Description">Timestamp of the last seek operation.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">last_user_scan</td>
                            <td data-label="Description">Timestamp of the last scan operation.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">last_user_lookup</td>
                            <td data-label="Description">Timestamp of the last lookup operation.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">last_user_update</td>
                            <td data-label="Description">Timestamp of the last update operation.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    

    <div id="sp_missing_indexes">
        <!-- Procedure Description -->
        <div class="description-text">
            <h2 class="codehd">sp_missing_indexes</h2>
            <br>
            Returns costly missing indexes in a given database or all databases. Missing indexes are ranked by their potential performance benefit, calculated based on the user impact and query cost.
        </div>
    
        <!-- Input Parameters -->
        <div class="description-text">
            <h3 class="table-header">Parameters</h3>
            <br />
            <p><code>@database_name</code> - Specifies the name of a database to analyze. If <code>NULL</code>, returns missing indexes for all databases.</p>
            <br />
            <p><code>@is_current</code> - If set to <code>1</code>, returns missing indexes for the current database only.</p>
        </div>
    
        <!-- Output Columns -->
        <div class="description-text">
            <h3 class="table-header">Output</h3>
            <div class="description-table-container">
                <table class="description-table">
                    <thead>
                        <tr>
                            <th>Column</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td data-label="Column">group_handle</td>
                            <td data-label="Description">The unique identifier for the missing index group.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">index_advantage</td>
                            <td data-label="Description">A calculated metric that estimates the advantage of creating the missing index.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">avg_total_user_cost</td>
                            <td data-label="Description">The average cost of queries that would benefit from the missing index.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">avg_user_impact</td>
                            <td data-label="Description">The estimated percentage improvement in query performance if the missing index is created.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">user_seeks</td>
                            <td data-label="Description">The number of times queries attempted to use an index for seek operations but found it missing.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">user_scans</td>
                            <td data-label="Description">The number of times queries attempted to use an index for scan operations but found it missing.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">database_name</td>
                            <td data-label="Description">The name of the database where the missing index was identified.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">table_name</td>
                            <td data-label="Description">The name of the table where the missing index is suggested.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">equality_columns</td>
                            <td data-label="Description">The columns used in equality comparisons in the queries benefiting from the index.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">inequality_columns</td>
                            <td data-label="Description">The columns used in inequality comparisons in the queries benefiting from the index.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">included_columns</td>
                            <td data-label="Description">The columns that should be included in the index to cover queries effectively.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    

    <div id="sp_index_frag">
        <!-- Procedure Description -->
        <div class="description-text">
            <h2 class="codehd">sp_index_frag</h2>
            <br>
            Provides insights into index fragmentation across one or more databases. Highlights indexes with fragmentation above the specified threshold.
        </div>

    
        <!-- Input Parameters -->
        <div class="description-text">
            <h3 class="table-header">Parameters</h3>
            <br />
            <p><code>@database_name</code> - The name of the database to analyze. If <code>NULL</code>, analyzes all eligible databases.</p>
            <br />
            <p><code>@min_frag</code> - The minimum fragmentation percentage for filtering indexes.</p>
            <br />
            <p><code>@min_table_size</code> - The minimum table size (in pages) to filter the results.</p>
            <br />
            <p><code>@print_command</code> - If set to <code>1</code>, prints the dynamic SQL commands for debugging purposes. Default: 0</p>
            <br />
            <p><code>@execute_command</code> - If set to <code>1</code>, executes the generated SQL commands to analyze fragmentation. Default: 1</p>
        </div>
    
        <!-- Output Columns -->
        <div class="description-text">
            <h3 class="table-header">Output Columns</h3>
            <div class="description-table-container">
                <table class="description-table">
                    <thead>
                        <tr>
                            <th>Column</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td data-label="Column">database_name</td>
                            <td data-label="Description">The name of the database containing the index.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">object_name</td>
                            <td data-label="Description">The name of the table or view containing the index.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">index_name</td>
                            <td data-label="Description">The name of the index being analyzed.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">schema_name</td>
                            <td data-label="Description">The schema of the table or view containing the index.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">avg_fragmentation_percent</td>
                            <td data-label="Description">The average fragmentation percentage of the index.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">index_type_desc</td>
                            <td data-label="Description">The type of index (e.g., CLUSTERED, NONCLUSTERED).</td>
                        </tr>
                        <tr>
                            <td data-label="Column">allocation_unit_type</td>
                            <td data-label="Description">The type of allocation unit (e.g., IN_ROW_DATA, LOB_DATA).</td>
                        </tr>
                        <tr>
                            <td data-label="Column">has_large_data_type</td>
                            <td data-label="Description">Indicates whether the table contains large data types (e.g., LOB, XML, or MAX types).</td>
                        </tr>
                        <tr>
                            <td data-label="Column">table_size</td>
                            <td data-label="Description">The size of the table in pages.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>


    
    <div id="sp_long_queries">
        <!-- Procedure Description -->
        <div class="description-text">
            <h2 class="codehd">sp_long_queries</h2>
            <br>
            Identifies long-running queries across all databases in a SQL Server instance using Query Store data. 
        </div>
    
   
    
        <!-- Input Parameters -->
        <div class="description-text">
            <h3 class="table-header">Parameters</h3>
            <br />
            <p><code>@days_back</code> - Filters queries executed within the specified number of days back from the current date. Default: 5</p>
            <br />
            <p><code>@min_duration_ms</code> - Filters queries with a maximum execution duration (in milliseconds) greater than this value. Default: 10,000</p>
            <br />
            <p><code>@include_unnamed_objects</code> - If <code>1</code>, includes queries from unnamed objects (e.g., ad hoc queries). If <code>0</code>, excludes unnamed objects. Default: 1</p>
        </div>
    
        <!-- Output Columns -->
        <div class="description-text">
            <h3 class="table-header">Output Columns</h3>
            <div class="description-table-container">
                <table class="description-table">
                    <thead>
                        <tr>
                            <th>Column</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td data-label="Column">database_name</td>
                            <td data-label="Description">The name of the database where the query was executed.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">execution_type</td>
                            <td data-label="Description">The type of execution (e.g., stored procedure, ad hoc query).</td>
                        </tr>
                        <tr>
                            <td data-label="Column">query_id</td>
                            <td data-label="Description">The unique identifier for the query within the Query Store.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">object_id</td>
                            <td data-label="Description">The object ID of the query (e.g., stored procedure ID).</td>
                        </tr>
                        <tr>
                            <td data-label="Column">max_duration_ms</td>
                            <td data-label="Description">The maximum duration (in milliseconds) of the query execution.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">set_options</td>
                            <td data-label="Description">The SET options in effect when the query was executed.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">name</td>
                            <td data-label="Description">The name of the object containing the query (e.g., stored procedure name).</td>
                        </tr>
                        <tr>
                            <td data-label="Column">total_duration_ms</td>
                            <td data-label="Description">The total execution time (in milliseconds) across all executions of the query.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">query_sql_text</td>
                            <td data-label="Description">The SQL text of the query.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    
    
    <div id="sp_long_proc_xe">
        <!-- Procedure Description -->
        <div class="description-text">
            <h2 class="codehd">sp_long_proc_xe</h2>
            <br>
            Retrieves details of long-running stored procedure calls or queries captured by Extended Events. Provides insights into query performance by filtering based on duration, database name, client hostname, or SQL statement patterns.   </div>
    

    
        <!-- Input Parameters -->
        <div class="description-text">
            <h3 class="table-header">Parameters</h3>
            <br />
            <p><code>@xe_session</code> - The name of the Extended Events session to retrieve data from. Default: <code class="cd">'Proc_Calls'</code>.</p>
            <br />
            <p><code>@database_name</code> - Filters results to include only events from a specific database. Default: <code>NULL</code> (no filtering).</p>
            <br />
            <p><code>@duration</code> - Filters results to include only events with a duration greater than this value (in microseconds). Default: <code>NULL</code> (no filtering).</p>
            <br />
            <p><code>@hostname</code> - Filters results to include only events generated by a specific client host. Default: <code>NULL</code> (no filtering).</p>
            <br />
            <p><code>@statement</code> - Filters results to include only events containing a specific SQL statement or pattern. Default: <code>NULL</code> (no filtering).</p>
        </div>
    
        <!-- Output Columns -->
        <div class="description-text">
            <h3 class="table-header">Output</h3>
            <div class="description-table-container">
                <table class="description-table">
                    <thead>
                        <tr>
                            <th>Column</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td data-label="Column">timestamp</td>
                            <td data-label="Description">The time the query was executed.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">database_name</td>
                            <td data-label="Description">The name of the database where the query was executed.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">duration</td>
                            <td data-label="Description">The duration of the query in microseconds.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">statement</td>
                            <td data-label="Description">The SQL statement executed.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">hostname</td>
                            <td data-label="Description">The client machine that executed the query.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    

    
    <div id="sp_job_info">
        <!-- Procedure Description -->
        <div class="description-text">
            <h2 class="codehd">sp_job_info</h2>
            <br>
            Retrieves detailed information about SQL Server Agent jobs. Identifies jobs that failed based on historical data. Drills down into specific job steps to troubleshoot issues.
        </div>
    
            <!-- Input Parameters -->
        <div class="description-text">

            <h3 class="table-header">Parameters</h3>
            <br />
            <p><code>@start_date</code> - Filters jobs by execution start date. If <code>NULL</code>, no filter is applied.</p> <br />
            <p><code>@job_owner</code> - Filters jobs by the ownerâ€™s name. If <code>NULL</code>, no filter is applied.</p> <br />
            <p><code>@run_status</code> - Filters jobs by their execution status. Example values: <code>0</code> (Failed), <code>1</code> (Succeeded). If <code>NULL</code>, no filter is applied.</p> <br />
            <p><code>@step_name</code> - Filters jobs by the name of a specific step. If <code>NULL</code>, no filter is applied.</p>
        </div>
    
       
    
        <!-- Output Tables -->
        <div class="description-text">
            <h3 class="table-header">Output</h3>
            <br />
            <!-- Section 1 -->
            <h4>1. Jobs Sorted by Execution Start Time</h4>
            <br />

            <div class="description-table-container">
                <table class="description-table">
                    <thead>
                        <tr>
                            <th>Column</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td data-label="Column">job_name</td>
                            <td data-label="Description">The name of the SQL Server Agent job.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">description</td>
                            <td data-label="Description">A description of the job.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">start_execution_date</td>
                            <td data-label="Description">The date and time the job started execution.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <br />
        
            <!-- Section 2 -->
            <h4>2. Jobs with Their Owners</h4>
            <br />

            <div class="description-table-container">
                <table class="description-table">
                    <thead>
                        <tr>
                            <th>Column</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td data-label="Column">job_name</td>
                            <td data-label="Description">The name of the SQL Server Agent job.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">job_owner</td>
                            <td data-label="Description">The name of the user who owns the job.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <br />
        
            <!-- Section 3 -->
            <h4>3. Jobs That Failed Execution</h4>
            <br />

            <div class="description-table-container">
                <table class="description-table">
                    <thead>
                        <tr>
                            <th>Column</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td data-label="Column">job_name</td>
                            <td data-label="Description">The name of the SQL Server Agent job.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">step_name</td>
                            <td data-label="Description">The name of the specific step in the job.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">sql_severity</td>
                            <td data-label="Description">The severity level of the SQL error, if any.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">message</td>
                            <td data-label="Description">The error message associated with the job or step failure.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">run_date</td>
                            <td data-label="Description">The date the job was run.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">run_time</td>
                            <td data-label="Description">The time the job was run.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <br />
        
            <!-- Section 4 -->
            <h4>4. Jobs with Specific Step Name </h4>
            <br />
            
            <div class="description-table-container">
                <table class="description-table">
                    <thead>
                        <tr>
                            <th>Column</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td data-label="Column">job_name</td>
                            <td data-label="Description">The name of the SQL Server Agent job.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">step_name</td>
                            <td data-label="Description">The name of the specific step in the job.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">sql_severity</td>
                            <td data-label="Description">The severity level of the SQL error, if any.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">message</td>
                            <td data-label="Description">The error message associated with the job or step.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">run_date</td>
                            <td data-label="Description">The date the job was run.</td>
                        </tr>
                        <tr>
                            <td data-label="Column">run_time</td>
                            <td data-label="Description">The time the job was run.</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        



    </div>

        
    <div id="sp_long_jobs">
        <!-- Procedure Description -->
        <div class="description-text">
            <h2 class="codehd">sp_long_jobs</h2>
            <br>
            Detects long running SQL Server Agent jobs by comparing current execution duration against thresholds derived from historical averages or default limits. If specified sends email notification for detected jobs.
        </div>
    
     
    
        <!-- Input Parameters -->
        <div class="description-text">
            <h3 class="table-header">Input Parameters</h3>
            <br />
            <p><code>@deviation_times</code> - Multiplier for historical average duration to define a threshold. Default: <code>3</code>.</p>
            <br />
            <p><code>@default_max_duration_minutes</code> - Fallback duration threshold (in minutes). Default: <code>15</code>.</p>
            <br />
            <p><code>@from_address</code> - Email address used for sending notifications. Optional.</p>
            <br />
            <p><code>@recipients</code> - Email addresses of recipients (comma-separated). Optional.</p>
        </div>
    
        <!-- Output Tables -->
        <div class="description-text">
            <h3 class="table-header">Output</h3>
            <br />
            
            <!-- Table 1: @RunningJobs -->
            <h4>1. Currrently Running Jobs</h4>
            <br />
            <div class="description-table-container">
                <table class="description-table">
                    <thead>
                        <tr>
                            <th>Column Name</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>job_id</td>
                            <td>Unique identifier for the job.</td>
                        </tr>
                        <tr>
                            <td>job_state</td>
                            <td>State of the job (e.g., running).</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <br />
            
            <!-- Table 2: @DetectedJobs -->
            <h4>2. Detected Long Running Jobs </h4>
            <br />
            <div class="description-table-container">
                <table class="description-table">
                    <thead>
                        <tr>
                            <th>Column Name</th>
                            <th>Description</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>job_name</td>
                            <td>The name of the SQL Server Agent job.</td>
                        </tr>
                        <tr>
                            <td>execution_date</td>
                            <td>The start date and time of the job execution.</td>
                        </tr>
                        <tr>
                            <td>avg_duration</td>
                            <td>Historical average execution duration (in seconds).</td>
                        </tr>
                        <tr>
                            <td>max_duration</td>
                            <td>Threshold duration (in seconds) for detecting long-running jobs.</td>
                        </tr>
                        <tr>
                            <td>current_duration</td>
                            <td>Current execution duration (in seconds).</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

  

</div>

<script src="script.js"></script>




    
    <footer>
        <p>&copy; 2025 SQL Inspector</p>
    </footer>
</body>
</html>
